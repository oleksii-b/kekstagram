(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{502:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return o}));var n=function(e){var t=e.effectName,r=e.effectLevel;switch(t){case"chrome":return"grayscale(".concat(r/100,")");case"sepia":return"sepia(".concat(r/100,")");case"marvin":return"invert(".concat(r,"%)");case"phobos":return"blur(".concat(3*r/100,"px)");case"heat":return"brightness(".concat(2*r/100+1,")")}};function o(e){document.body.style.overflow=e}},676:function(e,t,r){"use strict";r.r(t);var n=r(2),o=r.n(n),i=r(43),c=r(139),a=r(44),u=r(561),s=Object(u.a)((function(e){return e.pictures}),(function(e){return e.sortBy}),(function(e,t){switch(t){case"popular":return e.sort((function(e,t){return t.likes-e.likes}));case"most-commented":return e.sort((function(e,t){return t.comments.length-e.comments.length}));default:return e}})),l=r(672),f=r(502);function p(e){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function b(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function m(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function h(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var v=function(e){function t(){var e,r,n,i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var c=arguments.length,a=new Array(c),u=0;u<c;u++)a[u]=arguments[u];return n=this,i=(e=y(t)).call.apply(e,[this].concat(a)),r=!i||"object"!==p(i)&&"function"!=typeof i?m(n):i,h(m(r),"inputRef",o.a.createRef()),h(m(r),"onInputChange",(function(e){var t=e.target;if(t.files&&t.files[0]){var n=new FileReader;n.addEventListener("load",(function(e){var t=e.target;r.props.pictureEditorShow(),r.props.setPictureSrc(t.result)})),n.readAsDataURL(t.files[0])}})),h(m(r),"render",(function(){return o.a.createElement("fieldset",{className:"img-upload__start"},o.a.createElement("label",{className:"img-upload__label img-upload__control"},o.a.createElement("input",{id:"uploadFile",type:"file",className:"img-upload__input visually-hidden",ref:r.inputRef,onInput:r.onInputChange,name:"filename"}),"Загрузить"))})),r}var r,n,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(t,e),r=t,(n=[{key:"componentDidUpdate",value:function(){this.props.pictureSrc||(this.inputRef.current.value=null,this.props.isUploading&&(this.inputRef.current.click(),this.props.setUploadingStatus(!1)))}}])&&b(r.prototype,n),i&&b(r,i),t}(o.a.PureComponent);var g=Object(c.b)((function(e){return{pictureSrc:e.pictureFormData.src,isUploading:e.pictureEditor.isUploading}}),(function(e){return Object(i.b)({pictureEditorShow:a.f,setPictureSrc:a.s,setUploadingStatus:a.t},e)}))(v);function O(e){return(O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function P(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function w(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function j(e){return(j=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function E(e,t){return(E=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function S(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var D=o.a.lazy((function(){return Promise.all([r.e(0),r.e(5),r.e(8)]).then(r.bind(null,675))})),k=o.a.lazy((function(){return Promise.all([r.e(0),r.e(11)]).then(r.bind(null,671))})),R=function(e){function t(){var e,r,n,i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var c=arguments.length,a=new Array(c),u=0;u<c;u++)a[u]=arguments[u];return n=this,i=(e=j(t)).call.apply(e,[this].concat(a)),r=!i||"object"!==O(i)&&"function"!=typeof i?_(n):i,S(_(r),"state",{picture:null,isEditorVisible:!1}),S(_(r),"componentDidMount",(function(){r.props.initialize(),window.addEventListener("click",(function(e){e.target===r.overlay&&r.resetPictureEditor()}))})),S(_(r),"componentDidUpdate",(function(e,t){r.overlay&&r.state.picture!==t.picture&&(r.overlay.scrollTop=0,r.props.initialize())})),S(_(r),"setOverlayRef",(function(e){return r.overlay=e})),S(_(r),"submitForm",(function(e){e.preventDefault(),r.props.handleSubmit(),r.props.invalid||r.props.postPicture(new FormData(e.target))})),S(_(r),"resetPictureEditor",(function(){r.overlay.scrollTop=0,r.props.pictureEditorHide(),r.props.setDefaultValues(),r.props.initialize()})),S(_(r),"onHashtagsChange",(function(e){var t=e.target;r.props.setPictureHashtags(t.value)})),S(_(r),"render",(function(){var e=r.props,t=e.isHidden,n=e.effect,i=e.effectLevel,c=e.scale,a=e.setPictureHashtags,u=r.state,s=u.picture,l=u.isEditorVisible;return o.a.createElement("form",{action:"https://js.dump.academy/kekstagram",className:"img-upload__form",id:"upload-select-image",method:"post",encType:"multipart/form-data",autoComplete:"off",onSubmit:r.submitForm},o.a.createElement(g,null),o.a.createElement(o.a.Suspense,{fallback:null},l&&o.a.createElement(D,{isHidden:t,hide:r.resetPictureEditor,effectName:n,setOverlayRef:r.setOverlayRef,setPictureHashtags:a},o.a.createElement(k,{scale:c,src:s,effectName:n,effectLevel:i,alt:"Предварительный просмотр фотографии"}))))})),r}var r,n,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&E(e,t)}(t,e),r=t,i=[{key:"getDerivedStateFromProps",value:function(e,t){var r=e.src,n=e.isHidden,o=e.isLoaded,i=e.initialize,c={};return Object(f.b)(n?"visible":"hidden"),o&&i(),t.isEditorVisible||n||(c.isEditorVisible=!0),function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?P(Object(r),!0).forEach((function(t){S(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):P(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},c,{picture:r})}}],(n=null)&&w(r.prototype,n),i&&w(r,i),t}(o.a.PureComponent);var L=Object(c.b)((function(e){var t=e.pictureFormData,r=t.src,n=t.scale,o=t.effect,i=t.effectLevel,c=t.hashtags,a=t.description,u=e.pictureEditor.isHidden;return{isLoaded:e.picturePostRequest.isLoaded,src:r,scale:n,effect:o,effectLevel:i,hashtags:c,description:a,isHidden:u}}),(function(e){return Object(i.b)({postPicture:a.g,pictureEditorHide:a.e,setPictureSrc:a.s,setPictureHashtags:a.q,setPictureDescription:a.n,setDefaultValues:a.m},e)}))(Object(l.a)({form:"form",enableReinitialize:!0,onSubmit:function(){}})(R));function N(e){return(N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function H(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function A(e){return(A=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function C(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function T(e,t){return(T=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function F(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var U=function(e){function t(e){var r,n,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,i=A(t).call(this,e),r=!i||"object"!==N(i)&&"function"!=typeof i?C(n):i,F(C(r),"setActivePicture",(function(e){e.preventDefault(),r.props.setActivePicture(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?H(Object(r),!0).forEach((function(t){F(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):H(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},r.props.data,{url:r.url}))})),F(C(r),"render",(function(){var e=r.props.data,t=e.url,n=e.description,i=e.comments,c=e.likes;return r.url="https://github.com/oleksii-b/kekstagram/blob/master/assets/img/".concat(r.props.data.url,"?raw=true"),o.a.createElement("a",{href:t,className:"picture",onClick:r.setActivePicture},o.a.createElement("img",{className:"picture__img",src:r.url,width:"182",height:"182",alt:n}),o.a.createElement("div",{className:"picture__info"},o.a.createElement("span",{className:"picture__comments"},i.length),o.a.createElement("span",{className:"picture__likes"},c)))})),r.url=null,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&T(e,t)}(t,e),t}(o.a.Component);var V=Object(c.b)(null,(function(e){return Object(i.b)({setActivePicture:a.l},e)}))(U);function z(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function q(e){return(q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function x(e){return(x=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function I(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function B(e,t){return(B=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function J(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var M=function(e){function t(){var e,r,n,i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var c=arguments.length,a=new Array(c),u=0;u<c;u++)a[u]=arguments[u];return n=this,i=(e=x(t)).call.apply(e,[this].concat(a)),r=!i||"object"!==q(i)&&"function"!=typeof i?I(n):i,J(I(r),"state",{pictures:[],isPosting:!1}),J(I(r),"componentDidMount",(function(){r.props.getPictures()})),J(I(r),"render",(function(){var e=r.state.pictures;return o.a.createElement("section",{className:"pictures container"},o.a.createElement("h2",{className:"pictures__title visually-hidden"},"Фотографии других пользователей"),o.a.createElement("section",{className:"img-upload"},o.a.createElement("div",{className:"img-upload__wrapper"},o.a.createElement("h2",{className:"img-upload__title visually-hidden"},"Загрузка фотографии"),o.a.createElement(L,null))),!!e.length&&e.map((function(e){return o.a.createElement(V,{key:e.url,data:e})})))})),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&B(e,t)}(t,e),t}(o.a.PureComponent);J(M,"getDerivedStateFromProps",(function(e,t){var r=!1;"boolean"!=typeof e.isLoaded||t.isPosting||(e.isLoaded&&e.setDefaultValues(),e.pictureEditorHide(),r=!0);var n=e.location.search.slice(1),o=e.pictures;return s({pictures:o,sortBy:n}),"new"===n&&(o=z(e.loadedPictures)),{pictures:o,isPosting:r}}));t.default=Object(c.b)((function(e){var t=e.picturePostRequest,r=t.isLoading,n=t.isLoaded,o=e.picturesGetRequest.data;return{isLoading:r,isLoaded:n,pictures:o,loadedPictures:z(o),hashtags:e.pictureFormData.hashtags}}),(function(e){return Object(i.b)({getPictures:a.a,pictureEditorHide:a.e,setDefaultValues:a.m,resetPostRequestStatus:a.k},e)}))(M)}}]);